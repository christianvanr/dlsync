---version: 0, author: DlSync
CREATE OR REPLACE DYNAMIC TABLE ${EXAMPLE_DB}.${MAIN_SCHEMA}.DAILY_ORDERS
    TARGET_LAG = '30 minutes'
    WAREHOUSE = ${MY_WAREHOUSE}
AS
    SELECT
        PRODUCT_ID,
        SUM(QUANTITY) AS TOTAL_QUANTITY,
        ORDER_DATE::DATE AS ORDER_DATE,
        COUNT(*) AS ORDER_COUNT
    FROM ${MAIN_SCHEMA}.ORDERS
    GROUP BY ORDER_DATE::DATE, PRODUCT_ID;
---rollback: DROP DYNAMIC TABLE IF EXISTS ${EXAMPLE_DB}.${MAIN_SCHEMA}.DAILY_ORDERS;
---verify: SELECT * FROM ${EXAMPLE_DB}.${MAIN_SCHEMA}.DAILY_ORDERS LIMIT 1;